#!/bin/sh

<%- webroot_path = node[:letsencrypt][:webroot_path] %>
<%- mode = webroot_path ? "--webroot -w #{webroot_path}" : "--standalone" %>

certbot certonly \
  --config-dir <%= node[:letsencrypt][:config_dir] %> \
  --cert-name <%= node[:letsencrypt][:cert_name] %> \
  --noninteractive \
  --agree-tos \
  --email <%= @email %> \
  --no-eff-email \
  <%= mode %> \
  -d <%= @ssl_domains.join(",") %>
